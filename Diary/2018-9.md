# 2018-9-4 Tuesday

> 9月份计划

* 新表格接入
* 可视化平台画布无限增长 done

# 2018-9-12

iscroll中的scrollToElement是通过计算元素的offsetParent来做的，当有一种情况下回出问题，就是我们的dom都不在文档流中，都是通过transform来定位的。
那么只能手动计算每个dom transform的值，通过scrollTo方法来实现需求。

## Linux 中的 wheel 组和 staff 组

> wheel 组的概念

wheel 组的概念继承自 UNIX。当服务器需要进行一些日常系统管理员无法执行的高级维护时，往往就要用到 root 权限；而“wheel” 组就是一个包含这些特殊权限的用户池；也就是说，如果你不是“wheel”组的成员，就无法取得 root 权限进行一些特权的操作；

> 为什么需要 wheel 组？

通常在UNIX下，即使我们是系统的管理员，也不推荐用 root 用户登录来进行系统管理。一般情况下用普通用户登录，在需要 root 权限执行一些操作时，再 su 登录成为 root 用户。但是，任何人只要知道了 root 的密码，就都可以通过 su 命令来登录为 root 用户——这无疑为系统带来了安全隐患。所以，将普通用户加入到 wheel 组，被加入的这个普通用户就成了管理员组内的用户，但如果不对一些相关的配置文件进行配置，这个管理员组内的用户与普通用户也没什么区别——就像警察下班后，没有带枪、穿这便衣和普通人（用户）一样，虽然他的的确确是警察。

## nginx中location的语法

```
Syntax: location [ = | ~ | ~* | ^~ ] uri {...}
        location @name {...}
Default: -
Context: server, location
```

location匹配是针对一个标准化后的URI进行的，标准化可能有如下几种操作：

* 解码 “@xx” 这种格式的uri
* 解析带有由 . 和 .. 组成的相对路径，解析成绝对路径
* 如果 merge_slashes 指令没有被关闭（默认是开启），则自动将两个相邻的斜杠合并成一个斜杠（ //test --> /test ）

一个location可以是前缀匹配字符串，也可以是正则表达式。正则表达式由 ```~*``` 和 ```~``` 修饰，前者不匹配大小写，后者匹配大小写。为请求找到一个匹配的location，nginx首先会检查所有的前缀匹配字符串，被最大长度匹配到的location将会被选中和保存。接下来会检查正则表达式location，按照它们出现在配置文件中的顺序依次检查，直到匹配到第一个满足条件的location，结束检查。如果一个都没有匹配上，那么上一个被保存的location会被使用。
location块可以嵌套。
如果一个最长前缀匹配字符串拥有 ^~ 修饰符，则正则表达式不会被检查，同样地， = 修饰符被用来做精确匹配。如果一个location被精确匹配到了，则结束匹配。比如说，如果 "/" 这个请求经常发生，那么定义一个 ”location = /“ 可以加快处理请求的速度。

针对上面的语法，我们来举几个例子：

```
location = / {
    [ configuration A ]
}

location / {
    [ configuration B ]
}

location /documents/ {
    [ configuration C ]
}

location ^~ /images/ {
    [ configuration D ]
}

location ~* \.(gif|jpg|jpeg)$ {
    [ configuration E ]
}
```

请求“/”会匹配配置A，请求“/index.html”会匹配配置B，请求“/document/document.html”会匹配配置C，请求“/images/1.gif”会匹配配置D，请求“/documents/1.jpg”会匹配配置E

一个带有@前缀的location，不是用来做普通的请求处理的，而是用来做重定向。他们不能嵌套，不能包含嵌套的location块。

如果一个location由一个斜杠结尾，那么这个请求会被以下其中一个程序处理： proxy_pass, fastcgi_pass, uwsgi_pass, scgi_pass, memcached_pass, grpc_pass。如果一个URI匹配上了这个location，但是末尾没有斜杠，那么一个永久重定向（301）会被返回，重定向的地址就是原URI再加一个斜杠。如果这不是你所期望的，你可以这样：

```
location /user/ {
    proxy_pass http://user.example.com;
}

location = /user {
    proxy_pass http://login.example.com;
}
```